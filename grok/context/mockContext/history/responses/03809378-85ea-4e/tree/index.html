<!doctype html>
<html>
<head>
  <meta charset="utf-8"/>
  <title>Home Page</title>
</head>
<body>
  <nav>
    <button id="saveButton" onclick="saveButton()">Save html</button>
    <a id="parentContentLink" href='javascript:goHomePage()'>Home</a>
    <select id="childSubjects">
      <option value="home">Home</option>
      <!-- Children are added here onload with setChildSubjects -->
    </select>
    <!-- Add a previous and next button for prior requests? -->
    <!-- Add a button to save the current page as a markdown file -->
  </nav>

  <div id="content">  
    <div id="parentContent">
        <p>Here are two fruits:</p>
<ul>
<li><strong>Apple</strong></li>
<li><strong>Banana</strong></li>
</ul>
<hr>
<p>Follow-up questions:</p>
<ul>
<li>Would you like to know more about the nutritional benefits of these fruits?</li>
<li>Are there other fruits you're interested in learning about?</li>
<li>Do you have a favorite fruit you'd like to share?</li>
</ul>

    </div>
    <div id="childDivs">
      <div title="Apple" id="childContent1" onclick="setVisibileChild('childContent1')" hidden=true><h2>Apple</h2>
<h3>Overview</h3>
<p>The apple is a popular fruit that belongs to the rose family (Rosaceae). It is one of the most widely cultivated tree fruits, and its scientific name is <em>Malus domestica</em>. Apples come in a variety of colors, including red, yellow, and green, with different flavors and textures depending on the cultivar.</p>
<h3>Nutritional Benefits</h3>
<ul>
<li><p><strong>Vitamins and Minerals:</strong>
Apples are a good source of several essential nutrients. They contain:</p>
<ul>
<li><strong>Vitamin C:</strong> An antioxidant that helps protect your body against damage from free radicals.</li>
<li><strong>Potassium:</strong> Important for heart health and maintaining healthy blood pressure levels.</li>
<li><strong>Fiber:</strong> Particularly soluble fiber, which can help lower cholesterol levels and improve digestive health.</li>
</ul>
</li>
<li><p><strong>Antioxidants:</strong>
Apples are rich in antioxidants such as quercetin and catechin. These compounds help reduce the risk of chronic diseases like heart disease and cancer by neutralizing free radicals in the body.</p>
</li>
<li><p><strong>Low in Calories:</strong>
Apples are low in calories, with an average medium-sized apple containing about 95 calories. This makes them a great snack for those looking to maintain or lose weight.</p>
</li>
<li><p><strong>Hydration:</strong>
Apples have a high water content, which can help keep you hydrated.</p>
</li>
</ul>
<h3>Health Benefits</h3>
<ul>
<li><p><strong>Digestive Health:</strong>
The fiber in apples helps promote regular bowel movements and can prevent constipation. The pectin in apples acts as a prebiotic, feeding the good bacteria in the gut.</p>
</li>
<li><p><strong>Heart Health:</strong>
The fiber, potassium, and antioxidants in apples contribute to heart health. Studies suggest that regular consumption of apples can help lower the risk of heart disease.</p>
</li>
<li><p><strong>Weight Management:</strong>
Apples are filling due to their high fiber content and water content, which can help control hunger and reduce overall calorie intake.</p>
</li>
<li><p><strong>Diabetes Management:</strong>
The fiber in apples can help regulate blood sugar levels by slowing the digestion and absorption of carbohydrates.</p>
</li>
</ul>
<h3>Culinary Uses</h3>
<ul>
<li><p><strong>Fresh Eating:</strong>
Apples are most commonly eaten fresh, either whole or sliced. They can be enjoyed on their own or added to salads for a sweet and crunchy element.</p>
</li>
<li><p><strong>Cooking and Baking:</strong>
Apples are versatile in cooking and baking. They can be used in pies, crumbles, sauces, and cakes. Applesauce is a popular way to add moisture and sweetness to baked goods.</p>
</li>
<li><p><strong>Juicing:</strong>
Apple juice is a popular beverage, often enjoyed on its own or mixed with other fruit juices.</p>
</li>
<li><p><strong>Preservation:</strong>
Apples can be preserved through canning, freezing, or drying. Dried apples make a healthy snack, while apple cider and vinegar are popular fermented products.</p>
</li>
</ul>
<h3>Cultural Significance</h3>
<ul>
<li><p><strong>Symbolism:</strong>
Apples have various symbolic meanings in different cultures. In many Western cultures, apples symbolize knowledge and health, famously represented by the phrase "an apple a day keeps the doctor away."</p>
</li>
<li><p><strong>Mythology and Literature:</strong>
Apples appear in numerous myths and stories. In Norse mythology, the goddess Idunn is associated with apples that grant eternal youth. In Greek mythology, the golden apple plays a significant role in the story of Paris and the Trojan War.</p>
</li>
<li><p><strong>Festivals:</strong>
Many regions celebrate apple festivals, which often feature apple picking, apple-based foods, and community events centered around the fruit.</p>
</li>
</ul>
<h3>Varieties</h3>
<ul>
<li><p><strong>Red Delicious:</strong>
Known for its deep red color and mildly sweet flavor. It is often used for snacking.</p>
</li>
<li><p><strong>Granny Smith:</strong>
A green apple with a tart flavor, commonly used in cooking and baking.</p>
</li>
<li><p><strong>Gala:</strong>
A sweet and crisp apple, popular for eating fresh.</p>
</li>
<li><p><strong>Fuji:</strong>
Known for its sweetness and firmness, good for both eating fresh and in salads.</p>
</li>
<li><p><strong>Honeycrisp:</strong>
Noted for its crisp texture and balanced sweet-tart flavor, excellent for snacking.</p>
</li>
</ul>
<h3>Growing and Harvesting</h3>
<ul>
<li><p><strong>Climate and Soil:</strong>
Apples grow best in temperate climates with well-drained soil. They require a certain number of chilling hours to break dormancy and produce fruit.</p>
</li>
<li><p><strong>Pollination:</strong>
Most apple trees require cross-pollination from another apple variety to produce fruit. Bees play a crucial role in this process.</p>
</li>
<li><p><strong>Harvesting:</strong>
Apples are typically harvested in the fall. The exact timing depends on the variety and the desired ripeness. Some apples are picked green and allowed to ripen off the tree, while others are left to mature on the tree.</p>
</li>
<li><p><strong>Storage:</strong>
Apples can be stored for several months in a cool, dark place. Some varieties are better suited for long-term storage than others.</p>
</li>
</ul>
<p>This detailed overview should give you a comprehensive understanding of apples, covering their nutritional benefits, health advantages, culinary uses, cultural significance, varieties, and how they are grown and harvested.</p>
<hr>
<p>Follow-up questions:</p>
<ul>
<li>Would you like to know more about the specific health benefits of apples?</li>
<li>Are there particular apple varieties you're interested in learning about?</li>
<li>Do you have any favorite ways to enjoy apples that you'd like to share?</li>
</ul>
<p>ResponseID:8d8c4720-468c-4f</p>
</div><div title="Banana" id="childContent2" onclick="setVisibileChild('childContent2')" hidden=true><h2>Banana</h2>
<h3>Nutritional Benefits</h3>
<ul>
<li><strong>Vitamins and Minerals</strong>: Bananas are rich in vitamin B6, vitamin C, and potassium. Potassium is essential for heart health and helps regulate blood pressure.</li>
<li><strong>Dietary Fiber</strong>: They contain a good amount of dietary fiber, which aids in digestion and helps maintain bowel health.</li>
<li><strong>Energy Source</strong>: Bananas are a great source of quick energy due to their high carbohydrate content, making them popular among athletes.</li>
</ul>
<h3>Health Benefits</h3>
<ul>
<li><strong>Heart Health</strong>: The potassium in bananas helps in maintaining a healthy cardiovascular system by reducing the risk of stroke and heart disease.</li>
<li><strong>Digestive Health</strong>: The fiber content in bananas can help prevent constipation and promote regular bowel movements.</li>
<li><strong>Mood and Cognitive Function</strong>: Bananas contain tryptophan, which the body converts into serotonin, a neurotransmitter that can improve mood and cognitive function.</li>
</ul>
<h3>Culinary Uses</h3>
<ul>
<li><strong>Raw Consumption</strong>: Bananas are commonly eaten raw as a snack or added to cereals and smoothies.</li>
<li><strong>Cooking</strong>: They can be used in baking, such as in banana bread or muffins, and are also great when grilled or fried.</li>
<li><strong>Desserts</strong>: Bananas are a popular ingredient in desserts, like banana splits, and can be used to make ice cream or sorbet.</li>
</ul>
<h3>Varieties</h3>
<ul>
<li><strong>Cavendish</strong>: The most common type found in supermarkets, known for its sweet flavor and creamy texture.</li>
<li><strong>Plantain</strong>: A type of banana that is typically cooked before eating and has a starchy texture.</li>
<li><strong>Red Banana</strong>: Sweeter and smaller than the Cavendish, with a reddish-purple skin.</li>
</ul>
<h3>Cultural Significance</h3>
<ul>
<li><strong>Symbolism</strong>: In some cultures, bananas symbolize prosperity and good fortune.</li>
<li><strong>Traditional Uses</strong>: Bananas have been used in traditional medicine for centuries, particularly for digestive issues.</li>
</ul>
<h3>Environmental Impact</h3>
<ul>
<li><strong>Sustainability</strong>: Bananas are a relatively sustainable crop, but the use of pesticides and the transportation of bananas globally can have environmental impacts.</li>
<li><strong>Fair Trade</strong>: Choosing fair trade bananas can help support sustainable farming practices and fair wages for workers.</li>
</ul>
<p>ResponseID:0810386c-3561-4c</p>
</div>
    </div>
  </div>

    <script>
        function saveButton() {
          const content = document.documentElement.outerHTML; // Get the entire HTML content
          const blob = new Blob([content], { type: 'text/html' }); // Create a Blob from the content
          const url = URL.createObjectURL(blob); // Create a URL for the Blob
          const divInnerText = document.getElementById('content').innerText;
          let filename = divInnerText.substring(0, 25);
          const a = document.createElement('a'); // Create an anchor element
          a.href = url; // Set the href to the Blob URL
          
        a.download =  filename + '.html'; // Set the download attribute with a filename
          document.body.appendChild(a); // Append the anchor to the body
          a.click(); // Programmatically click the anchor to trigger the download
          document.body.removeChild(a); // Remove the anchor from the document
          URL.revokeObjectURL(url); // Release the Blob URL
        }
    </script>

    <script>
      function setChildSubjects(){
        let dropDownOptions = [];
        let childSubjects = document.getElementById('childDivs');
        for (let child of childSubjects.children){
           let subject = child.title;
           let optionValue = child.id;

           dropDownOptions.push({subject: subject, value: optionValue});
        
        }

        for (let option of dropDownOptions){
          let optionElement = document.createElement('option');
          optionElement.value = option.value;
          optionElement.text = option.subject;
          document.getElementById('childSubjects').appendChild(optionElement);
        }

        document.getElementById('childSubjects').addEventListener('change', function() {
          if(this.value == "home"){
            goHomePage();
          }else{
            setVisibleChild(this.value);
          }

          }
        );
      }
    </script>


    <script>
      function setVisibleChild(id){
        //quick flicker home to reset state, this allows hoping between child views
     
    
           let topNode = document.getElementById('content');
           let parentNode = document.getElementById('parentContent');
           let childVisibleNode = document.getElementById(id);
           let childDivs = document.getElementById('childDivs');
           for (let child of childDivs.children){
            if(child.id != id){
              child.hidden = true;
            }else{
              child.hidden = false; //redudant
            }
           }
           parentNode.hidden = true;
           childVisibleNode.hidden = false;
         }
      
    </script>

    <script>
      function goHomePage(){
         let topNode = document.getElementById('content');
         let parentNode = document.getElementById('parentContent');
         let children = document.getElementById('childDivs');
         for (let child of children.children){
            child.hidden = true;
         }
         parentNode.hidden = false;
      }
    </script>

    <script>
      function setChildLinks(){
        let children = document.getElementById('childDivs'); 
        let childSubjects = [];
        let discoveredMatches = [];

        
        for (let child of children.children){
          let subject = child.title;
          childSubjects.push({subject: subject, child: child});
          }
             
          let parentNodeH2Subjects = []
          let parentNodeH3Subjects = []
          let parentNodeH4Subjects = []
          let parentNode = document.getElementById('parentContent');
          let H2s = parentNode.getElementsByTagName("H2");
          let H3s = parentNode.getElementsByTagName("H3");
          let H4s = parentNode.getElementsByTagName("H4");
          let isH2Match = false;
          let isH3Match = false;
          let isH4Match = false;

          H2s.length > 0? parentNodeH2Subjects = H2s.map(item => ({subject: item.innerText, item: item})):isH2Match = false;
          H3s.length > 0?parentNodeH3Subjects = H3s.map(item => ({subject: item.innerText, item: item})):isH3Match = false;
          H4s.length > 0?parentNodeH4Subjects = H4s.map(item => ({subject: item.innerText, item: item})):isH4Match = false;

          
           isH3Match = H3s.length == childSubjects.length;
           isH2Match = H2s.length == childSubjects.length;
           isH4Match = H4s.length == childSubjects.length;
          let allDiscovered = false;

          if (isH3Match){
            //We have a match.  We need to find the H2s
            allDiscovered = true;
          }
          if (isH2Match){
            //We have a match.  We need to find the H3s
            allDiscovered = true;
          }
          if (isH4Match){
            //We have a match.  We need to find the H2s
            allDiscovered = true;
          }

          if(allDiscovered && (isH3Match + isH2Match + isH4Match) > 1){
            //wierd.  ok we work from scratch.
            allDiscovered = false;
          }

          if(!allDiscovered){

            let fluffWords = ["a", "an", "the", "and", "but", "or", "for", "nor", "on", "at", "to", "from", "by", "with", "of"];
            let fluffWordsRegex = new RegExp(fluffWords.join("|"), "g");
          
          //OK time to stumble through unpredictable llm output
          //First check if the child subjects are in the parent node h2 subjects
          let isH2 = false;
          let isH3 = false;
          let isH4 = false;
      
          //This can be optimized later.  Probably doesnt matter since it is client side with modern computing.
          for (let i = 0; i < parentNodeH2Subjects.length; i++){
            let subject = parentNodeH2Subjects[i].subject;
            for (let j = 0; j < childSubjects.length; j++){
              let childSubject = childSubjects[j].subject;
              if(childSubject.replace(fluffWordsRegex, "") == subject.replace(fluffWordsRegex, "")){
                isH2 = true;
                discoveredMatches.push({parentLink: parentNodeH2Subjects[i].item, childLink: childSubjects[j].child});
              }
            }

          }
         
          if(!isH2){
            for (let i = 0; i < parentNodeH3Subjects.length; i++){
              let subject = parentNodeH3Subjects[i].subject;
              for (let j = 0; j < childSubjects.length; j++){
                let childSubject = childSubjects[j].subject;  
                if(childSubject.replace(fluffWordsRegex, "") == subject.replace(fluffWordsRegex, "")){
                  isH3 = true;
                  discoveredMatches.push({parentLink: parentNodeH3Subjects[i].item, childLink: childSubjects[j].child});
                }
              }
            }
          }

          if(!isH3){
            for (let i = 0; i < parentNodeH4Subjects.length; i++){
              let subject = parentNodeH4Subjects[i].subject;
              for (let j = 0; j < childSubjects.length; j++){
                let childSubject = childSubjects[j].subject;
                if(childSubject.replace(fluffWordsRegex, "") == subject.replace(fluffWordsRegex, "")){
                  isH4 = true;
                  discoveredMatches.push({parentLink: parentNodeH4Subjects[i].item, childLink: childSubjects[j].child});
                }
              }
            }
          }

          if(!isH4){
              //I suppose there are edge cases but this surely covers 99.9% of the cases.
          }

          }else{
            if(isH3Match){
              for (let i = 0; i < parentNodeH3Subjects.length; i++){
                let child = childSubjects[i].child;
                makeChildLinks(parentNodeH3Subjects[i].item, child);
              }
              return; //bye bye
            }
            if(isH2Match){
              for (let i = 0; i < parentNodeH2Subjects.length; i++){
                let child = childSubjects[i].child;
                makeChildLinks(parentNodeH2Subjects[i].item, child);
                return; //bye bye
              }
              if(isH4Match){
                for (let i = 0; i < parentNodeH4Subjects.length; i++){
                  let child = childSubjects[i].child;
                  makeChildLinks(parentNodeH4Subjects[i].item, child);
                }
              }

            }

          }

          for (let match of discoveredMatches){
            makeChildLinks(match.parentLink, match.childLink);
            if(match.length < childSubjects.length){ alert("LLMM added additional info that is hidden");}
          }

        }
    </script>

    <script>
       function makeChildLinks(parent, child){
            parent.style.cursor = "pointer";
            parent.style.textDecoration = "underline";
            parent.style.color = "blue";
            parent.onclick = function(){
              setVisibleChild(child.id);
            }
       }

    </script>

<script>window.onload = setChildSubjects;</script>

</body>
</html>


   
    <!-- <textarea id="userPrompt"></textarea>

    <script>
        function nextButton() {
            const userPrompt = document.getElementById('userPrompt').value;
            console.log(userPrompt);
        }
    </script> -->